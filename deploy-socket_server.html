<!DOCTYPE html >
<html lang="en">
  <head>
    <title>	Logscape Documentation </title>
    <script src="js/kiss.js"> </script>
    <link href="css/bootstrap.min.css" rel="stylesheet"/>
    <link href="css/style.css" rel="stylesheet"/>
    <!--link(href="css/font-awesome-4.0.3/css/font-awesome.min.css",rel="stylesheet")-->
    <link href="css/style-app.css" rel="stylesheet"/>
    <link href="css/app.css" rel="stylesheet"/>
    <link href="//vjs.zencdn.net/4.9/video-js.css" rel="stylesheet"/>
    <script src="//vjs.zencdn.net/4.9/video.js"></script>
    <script src="js/jquery-1.11.0.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/navigation.js"></script>
    <script>
      function googleTranslateElementInit() {
      	new google.translate.TranslateElement({pageLanguage: 'en', layout: google.translate.TranslateElement.InlineLayout.SIMPLE}, 'google_translate_element');
      }
    </script>
    <script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
    <script>
      var breadcrumbs={
      	"gettingstarted":"Getting Started" 
      	,"searching":"Search"
      		,"kv":"Data Discovery"
      		,"offsets":"Using Offsets"
      		,"geoip":"Geo IP"
      		,"pattern":"Using Search Patterns"
      		,"video":"tutorials"
      		,"overlays":"Overlaying Searches" 
      	,"starthere":""
      
      	,"ds":"Data Sources"
      		,"add":" Add a New Data Source" 
      		,"multitags":" Using Multi-Tags"
      		,"syslog":" Connect Syslog Clients" 
      		,"tags": " Sources and Tags" 
      		,"intelligent_field_discovery":" Intelligent Field Discovery" 
      	,"types":"Data Types"
      		,"system_fields":"System Fields" 
      	,"deploy":"Deployment" 
      		,"app":" Logscape Apps"
      		,"agents": "Agents "
      		,"architectures_default": " Default Deployment"
      		,"architectures_failover": "Failover" 
      		,"architectures_indexstores": " Index Stores" 
      		,"architectures_tenured":"Tenured Data"
      		,"architectures_zones":" Zones" 
      		,"Backup": "Backup" 
      			,"home":" The Home Workspace"
      			,"import":" Restoring from Backup"
      			,"partial": " Selective Import"
      
      		,"arch_zoning":"Distributed Topology" 
      		,"arch_clm":"Centralized Monitoring Topology" 
      		,"arch_indexstores":"Multiple Index Store Topology" 
      
      		,"rawtcpserver": "Tcp Server"
      		,"syslogserer":"Syslog Server"
      		,"centralconfigs":"Centralized Configuration"
      		,"boot_properties":"Boot Properties"
      
      	,"users":"Users"
      		,"datagroups": "Data Groups"
      			,"nested": "Nested Groups"
      		,"faq":"Frequently Asked Questions" 
      	,"ldap":"Active Directory" 
      };
      $(window).load(function(){
      	function genLink(arr,idx){
      		if (idx<0) { return "/"; } 
      		var l="/"
      		for(i=0;i<=idx;i++){
      			l=l +  arr[i] + "-" ;
      		}
      		return l.substring(0,l.length-1) + ".html";
      	}
      
      	function upperFirst(string){
      		return string.charAt(0).toUpperCase() + string.slice(1);
      	}
      
      	function renderCrumbs(page){
      		//console.log("rendering breadcrumbs for page:" + page)
      		if (page.indexOf("-") < 0){
      			//console.log("<a href='/index.html'> Home </a> > <a href=" + page + ".html>" + page);
      			return ("<a href='/index.html'> Home </a> > <a href=" + page + ".html>" + upperFirst(page));
      		}
      		var parts=page.split("-");
      		var idx=0;
      		//console.log("rendering  " + parts);
      		var html="<a href='"+genLink(parts,-1)+"'> Home </a>";
      		for(idx=0;idx<parts.length;idx++){
      			k=parts[idx];
      		
      			html=html + "<a href="+ genLink(parts,idx) + ">";
      			if (breadcrumbs.hasOwnProperty(k)){
      				html=html + " >> " + breadcrumbs[k];
      			}else{
      				//console.log("nathen - " + k[0]);
      				html=html + " >> " + upperFirst(k.replace(/_/g, ' '));
      			}
      			//console.log(".");
      		}
      		//console.log("this far!!!");
      		return html
      	}
      	
      	var elems=window.location.href.split('?')[0].split('/');
      	var currentPage=elems[elems.length-1].split('.')[0]
      	//console.log("crumb>" + renderCrumbs(currentPage));	
      	$('#widget-bc').html(renderCrumbs(currentPage));
      });
      
      
    </script>
    <script>
      var blogFeed;
      function parseRSS(url, callback) {
      	$.ajax({
      		url: document.location.protocol + '//ajax.googleapis.com/ajax/services/feed/load?v=1.0&num=10&callback=?&q=' + encodeURIComponent(url),
      		dataType: 'json',
      		success: function(data) {
      			callback(data.responseData.feed);
      		}});
      }
      
      $(window).load(function() { 
      	parseRSS("http://blog.logscape.com/feed",function(feed){
      		var num = feed.entries.length;
      		for(i=0;i< num;i++){
      			var title=feed.entries[i].title;
      			//var link=feed.entries[i].
      			link=feed.entries[i].link;
      			$(".resource-list ul").append("<li><a href='"+link+"'>"+title+"</a> </li>")
      			blogFeed=feed;
      		}
      	});
      });
      
    </script>
    <script>
      $(window).bind("pageshow",function(){
      	var $form= $("form")[0];
      	$form.reset(); 
      });
      
    </script>
    <script>
      function submit_form(){
      	var q=$("#searchBox").val() 
      	q=encodeURIComponent(q)
      	var query="https://www.google.com/?gws_rd=cr&q=site:logscape.github.io+#q=site:logscape.github.io+"+q
      	var location = window.location.href;
      	console.log("back:" + location);
      	history.pushState({},"",location); 
      	window.location.replace(query);
      }
      
    </script>
  </head>
  <body>
    <div style="width:100%;height:85px;background-color:#333;">
      <!--div
      a(href="/") Documentation
      a(href="")  Forums 	| 
      a(href="") Getting Started	|
      a(href="") Logscape  	| 
      
      
      -->
      <div style="padding-left:100px;padding-top:25px"><a href="/index.html"> <img src="images/logscapeSupport.png" style="height:45px"/></a>
        <div style="float:right" class="col-md-3">
          <form id="cse-search-box" action="" style="position:right;padding-top:5px;padding-bottom:5px" onSubmit="submit_form()">
            <input type="hidden" name="cx" value="015161349156186070243:ktxh8djpql8"/>
            <input type="hidden" name="ie" value="UTF-8"/>
            <input id="searchBox" type="text" name="q" size="31" style="margin-left:15px"/>
            <input id="cseSubmit" type="submit" value=" " class="btn-search"/>
          </form>
        </div>
      </div>
    </div>
    <div style="width:100%;height:40px;background-color:#EEE;box-shadow: 0 0 2px #999;">
      <div style="padding-left:70px;padding-top:10px"><a href="/Cloud-Introduction.html">Cloud  | </a><a href="http://blog.logscape.com/dwqa-questions/">Forums   | </a><a href="/apps.html">Apps   | </a><a href="http://www.logscape.com">Logscape.com	</a>
        <div id="google_translate_element" class="float-right display-inline"></div><img style="height:0;width:0" src="http://logscape.com/images/track.png?version=support"/>
      </div>
    </div>
    <!--.container-fluid.navbar(style="min-height:30px;margin-bottom:5px;")
    .row(style="height:5px") 
    .row
    	.col-md-8
    	.col-md-1
    -->
    <div class="container-fluid">
      <!--.row
      .col-md-7
      	form#cse-search-box(action="",style="position:right;padding-top:5px;padding-bottom:5px",onSubmit="submit_form()")
      		a(href="/")
      			img(src="images/logo.png",style="padding-top:0px,padding-right:15px",width="150") 
      		input(type="hidden",name="cx",value="partner-pub-2789521296837340:9402765321")
      		input(type="hidden",name="ie",value="UTF-8")
      		input#searchBox(type="text",name="q",size="31",style="margin-left:15px")
      		input.btn-search#cseSubmit(type="submit",value=" ")
      		&nbsp;&nbsp;
      		a(href="http://apps.logscape.com") Apps |  
      		a(href="http://support.liquidlabs.co.uk") Release 1.3 | 
      		a(href="http://logscape.activeboard.com/") Forums  | 
      		a(href="gettingstarted.html") Getting Started 
      
      -->
      <div class="row">
        <div class="col-md-2"></div>
        <div class="col-md-5">
          <div id="widget-bc" padding-left:150px="padding-left:150px" class="breadcrumbs style">&nbsp;</div>
        </div>
      </div>
      <div class="row">
        <div class="col-md-2 nav-padding">
          <ul class="nav nav-tabs nav-stacked"></ul>
          <!--ul.nav.nav-tabs.nav-stacked  
          li
          	a(href="searching.html")&#9654; Search
          
          li 
          	a(href="workspaces.html")&#9654; WorkSpaces
          	ul
          
          li 
          	a(href="ds.html")&#9654; Data Sources
          li 
          	a(href="types.html")&#9654; Data Types 
          li
          	a(href="deploy.html")&#9654; Deployment
          li
          	a(href="users.html")&#9654; Users 
          li 
          	a(href="alerts.html")&#9654; Alerts 	
          li
          	a(href="technology.html")&#9654; Technology
          li
          	a(href="release-notes.html") Release Notes
          
          li
          	a.twitter-follow-button(href="https://twitter.com/logscape",data-show-count="false",data-size="large") Follow @logscape
          	script. 
          		=!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');
          -->
          <div style="padding-left:50px"> 
            <h4>Articles </h4>
          </div>
          <hr/>
          <div class="resource-list">
            <ul style="list-style:none;padding-left:10px;background-color:#FFFEE7"> </ul>
          </div>
        </div>
        <div class="col-md-9 content-area"> 
          <h3 id="breadcrumb">The Socket Server</h3>
          <p>The SocketServer allows live event streaming from any network device. Such inputs include Log4JSocketAppenders, SplunkForwarders or Snare Agents. The incoming stream of events is broken down into subdirectories which reflect the sourceIP and port. Each time a new a new connection is established the directory will be changed. i.e. 192.168.221.01_13000 indicates an incoming stream from the IP_Port combination.</p><br/>
          <p>To change the socket server port edit the <strong>boot.properties</strong> file and append/modify the following</p>
          <pre>sysprop=-Dsocket.server.port=123456</pre><em>A bounce will be required for this to take effect.<br/></em><br/><strong>Incoming Stream Data.</strong>
          <p>As the stream arrives the contents are inspected and demultiplexed using the mapping.csv file (as attached below). The mapping determines the set of rules which use used to breakdown the stream and write the contents into their relevant locations. This allows for a single stream of data to contain multiple types of data which can be imported into LogScape.</p><br/>
          <p>For Example</p>
          <ol>
            <li>Recieving
              <pre>Aug 23 02:02:43 10.22.111.254 Aug 23 2015 02:03:07: %ASA-5-111008: User 'support' executed the 'enable 15' command.</pre>
            </li>
            <li>Would send transfer to the following file
              <pre>.../logscape/SocketServer/172.16.101.101/172.16.101.101_50150/ASA/10.22.111.254/ ASA-11Aug23.log</pre>The Datatype would be assosciated with the record by running through the mapping.csv
              <pre>ASA,            timestamp=false,mline=false,appendNL=false,(\d+\.\d+\.\d+\.\d+) AND ASA-\d+</pre>
              <p>Where</p>
              <ul>
                <li>SocketServerRoot: is the location the Socket server is running. Generally in the logscape/work/directory. The location can be changed using: -Dsocket.server.root=/opt/logscape/SocketServer in the boot.properties and bouncing the system.</li>
                <li>ClientIP (172.100.101): is the sender IP address. This might be a Forwarder or the device itself.</li>
                <li>ClientIP_Port (172.12.100.101_50150): is the senders IP address and the port being sent from. Doing so allows for multiple senders from the same host, but also means that each session will go into a new directory.</li>
                <li>ASA: is picked up from the mapping.csv as the matching type</li>
                <li>10.22.111.254: was extracted during the stream match, and the group used to put the contents into the device subdirectory. Mutliple groups can be used when extracting from a line.</li>
                <li>ASA-11Aug23.log: is the name of the matching type with the current date appended. Doing so also allows for each days output to be placed into a new file and that files are manageable.</li>
              </ul>
            </li>
            <li>Other artifacts: raw-15Aug23.log and unknown-15Aug23.log
              <ul>
                <li>raw-XXXX.log is used to capture the raw state of the incoming stream. It is enabled by default and is the incoming stream written directly to disk with no processing. To disable raw output use: </li>
                <pre>-Dsocket.server.dump.raw=false</pre>
                <li>unknown-XXXX.log is used to capture events which have not been classified.</li>
              </ul>
            </li>
          </ol><strong>Mapping CSV Rules</strong>
          <p>The following displays the first couple of lines from a mapping.csv file. The order of the mapping is evaluated from the top down - and is therefore important to ensure the precendence is correct. i.e. more specific rules at the top.</p>
          <pre>#type-key,#timestamp,#mline=t/f,#flush a NL after receiving lines,# log-line-match-expression (beware of white space!)
MSWinEventLog, timestamp=false,mline=false,appendNL=false,(*)\s+MSWinEventLog\s+*\s+(*)
ASA-session, timestamp=false,mline=false,appendNL=false,(\d+\.\d+\.\d+\.\d+) AND ASA-session</pre><br/><br/>
          <table border="1" style="BORDER-BOTTOM-COLOR:#888;BORDER-RIGHT-WIDTH:1px;BORDER-TOP-COLOR:#888;BORDER-COLLAPSE:collapse;BORDER-TOP-WIDTH:1px;BORDER-BOTTOM-WIDTH:1px;BORDER-RIGHT-COLOR:#888;BORDER-LEFT-COLOR:#888;BORDER-LEFT-WIDTH:1px">
            <tr>
              <td>type-key</td>
              <td>MSWinEventLog</td>
              <td>Content will be placed into sub directory MSWinEventLog</td>
            </tr>
            <tr>
              <td>timestamp</td>
              <td>timestamp = false</td>
              <td>if true - each line will be prepended with a timestamp as it arrives</td>
            </tr>
            <tr>
              <td>mline</td>
              <td>mline=true</td>
              <td>true - Indicates whether or not to expect multiline events(Or very long line lenghts)</td>
            </tr>
            <tr>
              <td>flush</td>
              <td>appendNL</td>
              <td>- true will append a NL</td>
            </tr>
            <tr>
              <td>expression</td>
              <td>(*)</td>
              <td>The expression groups are used to recognize content and also determine the subdirectory. Each group () will form part of the path; hence allowing for hostnames, types to be used.</td>
            </tr>
          </table><br/>
          <p>As the incoming stream is evaluated, the appropriate output files will be streamed into. Any stream of data that is not recognized will be output into an {timestamp}-unknown.log file. By inspecting this file you can see those types not recognized, update the mapping.csv file and then bounce the SocketServer (so it is reconfigured). By default the mapping.csv is located within the system-properties/vs-log-server directory. To make the required changes copy it into the root LogScape directory and edit the file there.</p><br/><br/><br/>
          <div id="disqus_thread">
            <script>
              /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
              var disqus_shortname = 'logscape'; // required: replace example with your forum shortname
              /* * * DON'T EDIT BELOW THIS LINE * * */
              (function() {
              	var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
              	dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
              	(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
              })();
            </script>
          </div>
        </div>
      </div>
      <!--
      hr.dark 
      .col-md-3
      Logscape Copyright 2014(c) Registered Trademark 
      
      -->
    </div>
    <script>
      $( document ).ready(function() {
      
      	$("#cseSubmit").on("click",function(e){
      		e.preventDefault();
      		submit_form(); 
      	});
      	$("#searchBox").on("keypress",function(e){ 
      		if (e.keyCode == 13) { 
      			e.preventDefault();
      			submit_form() 
      		}
      	}); 
      });
      
    </script>
    <script>
      (function(g,i,a,n,t,s){g['SeeYourVisitors']=n;g[n]=g[n]||function(){
      (g[n].q=g[n].q||[]).push(arguments)},g[n].l=1*new Date();t=i.createElement(a),
      s=i.getElementsByTagName(a)[0];t.async=1;t.src='//seeyourvisitors2.appspot.com/gg.js';
      s.parentNode.insertBefore(t,s)})(window,document,'script','gg');
      gg('create', 'd1a8b082-8806-4793-936f-35f5e41b3592');
      gg('track');
    </script>
    <script src="js/ga.js"> </script>
  </body>
</html>