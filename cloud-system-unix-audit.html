<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Logscape Apps	</title>
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/style-app.css" rel="stylesheet">
    <link href="css/cloud-app.css" rel="stylesheet">
    <script src="js/bootstrap.min.js"></script>
    <script src="js/jquery.js"></script>
    <script src="js/angular-1.2.9/angular.min.js"></script>
    <script src="js/angular-1.2.9/angular-animate.min.js"></script>
    <script src="js/angular-1.2.9/angular-route.min.js"></script>
    <script src="js/app/controllers.js"> </script>
  </head>
  <body>
    <div style="width:100%;height:85px;background-color:#333;">
      <!--div
      a(href="/") Documentation
      a(href="")  Forums 	| 
      a(href="") Getting Started	|
      a(href="") Logscape  	| 
      -->
      <div style="padding-left:100px;padding-top:20px"><img src="images/logscape-apps-logo.png" style="height:45px"></div>
    </div>
    <div style="width:100%;height:40px;background-color:#EEE;box-shadow: 0 0 2px #999;">
      <div style="padding-left:140px;padding-top:10px"><a href="/">Documentation  | </a><a href="http://logscape.com">Main Website  | </a><a href="http://logscape.com/get.html">Download  | </a><a href="http://logscape.activeboard.com/">Forums   | </a><a href="/apps.html">Apps   | </a></div>
    </div>
    <div class="row">
      <div style="margin-left:10px" class="col-md-2 nav-padding"> 
        <hr>
        <ul class="nav nav-tabs nav-stacked">
          <p>Introduction</p>
          <li><a href="cloud-starthere.html">Getting Started </a></li>
          <li><a href="cloud-signup.html">Use Cases </a></li>
          <p>Stream Your Data </p>
          <li><a href="cloud-syslog.html">Syslog</a>
            <!--div 
            ul.nav.nav-tabs.nav-stacked
            	li 
            		a(href="cloud-syslog-ng.html") Syslog-NG
            	li 
            		a(href="") System Logs 					
            	li 
            		a(href="") Application Logs 
            -->
          </li>
          <li><a href="cloud-nxlog.html">Nxlog </a></li>
          <li><a href="cloud-collector.html">Collector </a></li>
          <p>System Data </p>
          <li> <a href="cloud-system-unix.html">Unix System Logs </a></li>
          <!--li a(href="cloud-system-unix-audit.html") Unix Audit Logs 	
          -->
          <li> <a href="cloud-system-windows.html">Windows System Logs </a></li>
          <li> <a href="cloud-system-windows-audit.html">Windows Audit Logs 	</a></li>
          <p>Application Data</p>
          <li> <a href="cloud-java-logs.html">Java Logs </a></li>
          <!--li a(href="cloud-dotnet-logs.html") DotNet Logs 
          -->
          <!--li 
          a(href="cloud-aws-logs.html") Amazon AWS 
          
          -->
          <!--lia(href="cloud-iis-logs.html") IIS Logs 
          -->
          <!--p Web Data-->
          <li><a href="cloud-apache-logs.html">Apache Logs</a></li>
          <li><a href="cloud-nginx-logs.html">Nginx Logs</a></li>
          <li><a href="cloud-web-logs.html">Web Logs</a></li>
          <p>Network Devices</p>
          <li><a href="cloud-juniper-logs.html">Juniper</a></li>
          <li> <a href="cloud-cisco-logs.html">Cisco ASA				</a></li>
        </ul>
      </div>
      <div class="col-md-9 apps">
        <div ng-app="docBrowserApp" class="row"> 
          <div>
            <h3>Logscape in the Cloud </h3>
            <h1> <strong>Configuring your Unix Audit Logs.</strong></h1>
            <p><i>What do you call an auditor that can't audit? An or.</i></p>
            <hr><strong>Unix Auditing Workspace</strong>
            <p>Have Unix audit logs? Need to have them visualized? then the Unix Auditing workspace is what you need.</p>
            <div style="padding-left:15px;" class="images"><img src="/images/cloud-java-workspace.png" width="600">
              <div class="side-box">
                <h4>Configuring Fields </h4><a href="types-tutorial.html">Types Tutorial </a><br><a href="types-fields.html">Fields </a><br><a href="types-field_discovery.html">Field Discovery</a><br><a href="types-field_grokit.html">Grokit Fields </a><br><a href="types-system_fields.html">System Fields </a><br>
              </div>
            </div>
            <h1>Stream your Unix audit logs, using auditd.</h1>
            <p>Auditd is a linux auditing tool, used when you want to monitor file access and modification. It is lightweight and with the addition of a syslog plugin can seamlessly stream your audit logs to the Logscape cloud.</p><br><strong>Step 1) Install Auditd</strong>
            <p>If you do not already have auditd on your machine then you can easily obtain it with use of the apt-get command.</p>
            <pre>sudo apt-get install auditd</pre>
            <p>once installed auditd will automatically start on boot</p><br><strong>Step 2) Configure auditd</strong>
            <p>By default your auditd rules can be located in the /etc/audit/ directory in a file named "audit.rules", to edit that file you can use the following command,</p>
            <pre>sudo vi /etc/audit/audit.rules</pre>
            <p> <i>As always, feel free to substitute vi for the editor of your choice.</i></p><br>
            <p>Below is an example auditd rules file</p>
            <pre># First rule - delete all
-D
 
# increase the buffers to survive stress events. make this bigger for busy systems.
-b 1024
 
# monitor unlink() and rmdir() system calls.
-a exit,always -S unlink -S rmdir
 
# monitor open() system call by Linux UID 1001.
-a exit,always -S open -F loginuid=1001
 
# monitor write-access and change in file properties (read/write/execute) of the following files.
-w /etc/group -p wa
-w /etc/passwd -p wa
-w /etc/shadow -p wa
-w /etc/sudoers -p wa
 
# monitor read-access of the following directory.
-w /etc/secret_directory -p r
 
# lock the audit configuration to prevent any modification of this file.
-e 2</pre>
            <p> <i>Obviously, you'll want to edit the auditd config to be appropriate to your establishment.</i></p><br>
            <p>By default the auditd deamon will output log files to /var/log/audit/audit.log - However this, among a full spectrum of other settings can be altered in the auditd.conf, this file is located in the same directory as the audit rules and can be modified with the following command.</p>
            <pre>sudo vi /etc/audit/auditd.conf</pre>
            <p>And this is what you'll see</p>
            <pre>#
# This file controls the configuration of the audit daemon
#
 
log_file = /var/log/audit/audit.log
log_format = RAW
log_group = root
priority_boost = 4
flush = INCREMENTAL
freq = 20
num_logs = 5
disp_qos = lossy
dispatcher = /sbin/audispd
name_format = NONE
##name = mydomain
max_log_file = 6
max_log_file_action = ROTATE
space_left = 75
space_left_action = SYSLOG
action_mail_acct = root
admin_space_left = 50
admin_space_left_action = SUSPEND
disk_full_action = SUSPEND
disk_error_action = SUSPEND
##tcp_listen_port =
tcp_listen_queue = 5
tcp_max_per_addr = 1
##tcp_client_ports = 1024-65535
tcp_client_max_idle = 0
enable_krb5 = no
krb5_principal = auditd
##krb5_key_file = /etc/audit/audit.key</pre>
            <p>For the sake of the this tutorial we won't need to edit this file, but it's useful to know where it is, for the remainder we'll be configuring rsyslog to monitor, and transfer our audit.log</p><br><strong>Step 3) Configure rsyslog</strong>
            <p> <i>This tutorial is going to presume that rsyslog is already installed on your system, if it is not, then check out the syslog guides on the navigation bar.</i></p><br>
            <p>Open your rsyslog configuration.</p>
            <pre>sudo vi /etc/rsyslog.conf</pre><br>
            <p>You'll be confronted by your rsyslog configuration file, the first step is to add a line to your config that allows rsyslog to turn any standard text file into a syslog message. For the sake of formatting we'll try to keep this neat, in your current config you'll see a block that looks like this</p>
            <pre># Provides TCP syslog reception
#$ModLoad imtcp.so  
#$InputTCPServerRun 514</pre>
            <p>We want to add this line to the block</p>
            <pre>$ModLoad imfile</pre>
            <p>so that we end up with...</p>
            <pre># Provides TCP syslog reception
#$ModLoad imtcp.so  
#$InputTCPServerRun 514
$ModLoad imfile</pre>
            <p>then we can add the following to the bottom of the config so that our audit logs are transferred</p>
            <pre># auditd audit.log  
$InputFileName /var/log/audit/audit.log  
$InputFileTag tag_audit_log:  
$InputFileStateFile audit_log  
$InputFileSeverity info  
$InputFileFacility local6  
$InputRunFileMonitor</pre>
            <p><i>note: You may need to edit the permissions of var/log/audit to allow syslog to read the files.</i></p>
          </div>
        </div><br><br><br>
        <div id="disqus_thread">
          <script>
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'logscape'; // required: replace example with your forum shortname
            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function() {
            	var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            	dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            	(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
          </script>
        </div>
      </div>
    </div>
  </body>
</html>
<!--
.container		
//		
	.navbar.navbar-fixed-top
		.navbar-inner
			.nav-collapse.collapse
				ul.nav
					li.active  Main Support Site 
					li Explore Logscape Apps 
					li 
						a(href="") Download 
			h3 Logscape Apps 
			a(href="index.html") Getting Started | 
			a(href="http://support.liquidlabs.co.uk")  Older Versions 1.3x Docs   

.container-fluid
	br
	br 
	br
	br
	br
	.row 
		.col-md-11(style="padding-left:100px")
			block content 
	
script(src="js/ga.js") 
-->
<!--
//
	.row
		.col-md-2.nav-padding
		
			br
	
			ul
				li
					a(href="https://github.com/logscape/windowsapp#windowsapp-10") WindowsApp
				li 
					a(href="https://github.com/logscape/unixapp#unixapp-10") UnixApp

				li 
					a(href="https://github.com/logscape/coherenceapp#oraclecoherenceapp-10") Oracle Coherence App

				li 
					a(href="https://github.com/logscape/javaapp#javaapp-10") JavaApp

				li 
					a(href="https://github.com/logscape/vmwareapp#vmwareapp-10") VMWareApp

				li
					a(href="https://github.com/logscape/ciscoapp#ciscoapp-10") Cisco Devices




		.col-md-10
			block content
-->