<!DOCTYPE html >
<html lang="en">
  <head>
    <title>	Logscape Documentation </title>
    <script src="js/kiss.js"> </script>
    <link href="css/bootstrap.min.css" rel="stylesheet"/>
    <link href="css/style.css" rel="stylesheet"/>
    <link href="css/font-awesome-4.0.3/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="css/style-app.css" rel="stylesheet"/>
    <link href="css/app.css" rel="stylesheet"/>
    <link href="//vjs.zencdn.net/4.9/video-js.css" rel="stylesheet"/>
    <script src="//vjs.zencdn.net/4.9/video.js"></script>
    <script src="js/jquery-1.11.0.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script>
      var breadcrumbs={
      	"gettingstarted":"Getting Started" 
      	,"searching":"Search"
      		,"kv":"Data Discovery"
      		,"offsets":"Using Offsets"
      		,"geoip":"Geo IP"
      		,"pattern":"Using Search Patterns"
      		,"video":"tutorials"
      		,"overlays":"Overlaying Searches" 
      	,"starthere":""
      
      	,"ds":"Data Sources"
      		,"add":" Add a New Data Source" 
      		,"multitags":" Using Multi-Tags"
      		,"syslog":" Connect Syslog Clients" 
      		,"tags": " Sources and Tags" 
      		,"intelligent_field_discovery":" Intelligent Field Discovery" 
      	,"types":"Data Types"
      		,"system_fields":"System Fields" 
      	,"deploy":"Deployment" 
      		,"app":" Logscape Apps"
      		,"agents": "Agents "
      		,"architectures_default": " Default Deployment"
      		,"architectures_failover": "Failover" 
      		,"architectures_indexstores": " Index Stores" 
      		,"architectures_tenured":"Tenured Data"
      		,"architectures_zones":" Zones" 
      		,"Backup": "Backup" 
      			,"home":" The Home Workspace"
      			,"import":" Restoring from Backup"
      			,"partial": " Selective Import"
      
      		,"arch_zoning":"Distributed Topology" 
      		,"arch_clm":"Centralized Monitoring Topology" 
      		,"arch_indexstores":"Multiple Index Store Topology" 
      
      		,"rawtcpserver": "Tcp Server"
      		,"syslogserer":"Syslog Server"
      		,"centralconfigs":"Centralized Configuration"
      		,"boot_properties":"Boot Properties"
      
      	,"users":"Users"
      		,"datagroups": "Data Groups"
      			,"nested": "Nested Groups"
      		,"faq":"Frequently Asked Questions" 
      	,"ldap":"Active Directory" 
      };
      $(window).load(function(){
      	function genLink(arr,idx){
      		if (idx<0) { return "/"; } 
      		var l="/"
      		for(i=0;i<=idx;i++){
      			l=l +  arr[i] + "-" ;
      		}
      		return l.substring(0,l.length-1) + ".html";
      	}
      
      	function upperFirst(string){
      		return string.charAt(0).toUpperCase() + string.slice(1);
      	}
      
      	function renderCrumbs(page){
      		console.log("rendering breadcrumbs for page:" + page)
      		if (page.indexOf("-") < 0){
      			console.log("<a href='/index.html'> Home </a> > <a href=" + page + ".html>" + page);
      			return ("<a href='/index.html'> Home </a> > <a href=" + page + ".html>" + upperFirst(page));
      		}
      		var parts=page.split("-");
      		var idx=0;
      		console.log("rendering  " + parts);
      		var html="<a href='"+genLink(parts,-1)+"'> Home </a>";
      		for(idx=0;idx<parts.length;idx++){
      			k=parts[idx];
      		
      			html=html + "<a href="+ genLink(parts,idx) + ">";
      			if (breadcrumbs.hasOwnProperty(k)){
      				html=html + " > " + breadcrumbs[k];
      			}else{
      				console.log("nathen - " + k[0]);
      				html=html + " > " + upperFirst(k.replace(/_/g, ' '));
      			}
      			console.log(".");
      		}
      		console.log("this far!!!");
      		return html
      	}
      	
      	var elems=window.location.href.split('?')[0].split('/');
      	var currentPage=elems[elems.length-1].split('.')[0]
      	console.log("crumb>" + renderCrumbs(currentPage));	
      	$('#widget-bc').html(renderCrumbs(currentPage));
      });
      
      
    </script>
    <script>
      var blogFeed;
      function parseRSS(url, callback) {
      	$.ajax({
      		url: document.location.protocol + '//ajax.googleapis.com/ajax/services/feed/load?v=1.0&num=10&callback=?&q=' + encodeURIComponent(url),
      		dataType: 'json',
      		success: function(data) {
      			callback(data.responseData.feed);
      		}});
      }
      
      $(window).load(function() { 
      	parseRSS("http://blog.logscape.com/feed",function(feed){
      		var num = feed.entries.length;
      		for(i=0;i< num;i++){
      			var title=feed.entries[i].title;
      			//var link=feed.entries[i].
      			link=feed.entries[i].link;
      			$(".resource-list ul").append("<li><a href='"+link+"'>"+title+"</a> </li>")
      			blogFeed=feed;
      		}
      	});
      });
      
    </script>
    <script>
      $(window).bind("pageshow",function(){
      	var $form= $("form")[0];
      	$form.reset(); 
      });
      
    </script>
    <script>
      function submit_form(){
      	var q=$("#searchBox").val() 
      	q=encodeURIComponent(q)
      	var query="https://www.google.com/?gws_rd=cr&q=site:logscape.github.io+#q=site:logscape.github.io+"+q
      	var location = window.location.href;
      	console.log("back:" + location);
      	history.pushState({},"",location); 
      	window.location.replace(query);
      }
      
    </script>
  </head>
  <body>
    <div style="width:100%;height:85px;background-color:#333;">
      <!--div
      a(href="/") Documentation
      a(href="")  Forums 	| 
      a(href="") Getting Started	|
      a(href="") Logscape  	| 
      
      
      -->
      <div style="padding-left:100px;padding-top:25px"><a href="/index.html"> <img src="images/logscapeSupport.png" style="height:45px"/></a>
        <div style="float:right" class="col-md-3">
          <form id="cse-search-box" action="" style="position:right;padding-top:5px;padding-bottom:5px" onSubmit="submit_form()">
            <input type="hidden" name="cx" value="015161349156186070243:ktxh8djpql8"/>
            <input type="hidden" name="ie" value="UTF-8"/>
            <input id="searchBox" type="text" name="q" size="31" style="margin-left:15px"/>
            <input id="cseSubmit" type="submit" value=" " class="btn-search"/>
          </form>
        </div>
      </div>
    </div>
    <div style="width:100%;height:40px;background-color:#EEE;box-shadow: 0 0 2px #999;">
      <div style="padding-left:70px;padding-top:10px"><a href="/Cloud-Introduction.html">Cloud  | </a><a href="http://logscape.activeboard.com/">Forums   | </a><a href="/apps.html">Apps   | </a><a href="http://www.logscape.com">Logscape.com	</a><img style="height:0;width:0" src="http://logscape.com/images/track.png?version=support"/></div>
    </div>
    <!--.container-fluid.navbar(style="min-height:30px;margin-bottom:5px;")
    .row(style="height:5px") 
    .row
    	.col-md-8
    	.col-md-1
    -->
    <div class="container-fluid">
      <!--.row
      .col-md-7
      	form#cse-search-box(action="",style="position:right;padding-top:5px;padding-bottom:5px",onSubmit="submit_form()")
      		a(href="/")
      			img(src="images/logo.png",style="padding-top:0px,padding-right:15px",width="150") 
      		input(type="hidden",name="cx",value="partner-pub-2789521296837340:9402765321")
      		input(type="hidden",name="ie",value="UTF-8")
      		input#searchBox(type="text",name="q",size="31",style="margin-left:15px")
      		input.btn-search#cseSubmit(type="submit",value=" ")
      		&nbsp;&nbsp;
      		a(href="http://apps.logscape.com") Apps |  
      		a(href="http://support.liquidlabs.co.uk") Release 1.3 | 
      		a(href="http://logscape.activeboard.com/") Forums  | 
      		a(href="gettingstarted.html") Getting Started 
      
      -->
      <div class="row">
        <div class="col-md-1"></div>
        <div class="col-md-2"></div>
        <div class="col-md-5">
          <div id="widget-bc" padding-left:150px="padding-left:150px" class="breadcrumbs style">&nbsp;</div>
        </div>
      </div>
      <div class="row">
        <div style="width:100px" class="col-md-1">
          <p></p>
        </div>
        <div class="col-md-2 nav-padding">
          <ul class="nav nav-tabs nav-stacked"> 
            <li><a href="searching.html">Search</a></li>
            <li> <a href="workspaces.html">WorkSpaces</a>
              <ul></ul>
            </li>
            <li> <a href="ds.html">Data Sources</a></li>
            <li> <a href="types.html">Data Types </a></li>
            <li><a href="deploy.html">Deployment</a></li>
            <li><a href="users.html">Users </a></li>
            <li> <a href="alerts.html">Alerts 	</a></li>
            <li><a href="technology.html">Technology</a></li>
            <li><a href="release-notes.html">Release Notes</a></li>
            <li><a href="https://twitter.com/logscape" data-show-count="false" data-size="large" class="twitter-follow-button">Follow @logscape</a>
              <script>=!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
            </li>
          </ul>
          <div style="padding-left:50px"> 
            <h4>Articles </h4>
          </div>
          <hr/>
          <div class="resource-list">
            <ul style="list-style:none;padding-left:10px;background-color:#FFFEE7"> </ul>
          </div>
        </div>
        <div class="col-md-9 content-area"> 
          <h6 id="breadcrumb">Searching Geotagged Data</h6>
          <p>Logscape can translate fields containing i.p address data into City,Country and long/latitude coordinates.</p>
          <div class="image"><img src="images/searching-geoip.png"/></div>
          <p>Logscape can translate fields containing i.p addresse data into City,Country and long/latitude coordinates. Update your system with the following config to see examples</p>
          <div class="image"><a href="./files/logscape-all-geoip.config">Geo-ip Examples</a></div>
          <p>The config contains searches and data types which use the geoip translation functionality. It also includes a new visualisation called &nbsp;<em>map &nbsp;</em>which will display your results on a zoomable map.</p>
          <h3>Configuring Your Datatype </h3>
          <p>To use geoip lookups in your data, enable your datatype to perform the look up on particular fields. For instance, if I had data with the following structure</p>
          <div class="image"><img src="images/searching-geoip-type.png"/></div>
          <p>My ip addresses are stored in the field clientIp.</p>
          <div class="alert alert-info"><strong>Note:</strong>The map chart type expects the fields:<em>country&nbsp;</em>and/or<em>&nbsp;city </em>as field names in the data type for the visualization to work as expected </div>
          <p>To perform the geo lookup you will need to use groovy synthetic function. The libraries are already included within logscape.</p>
          <pre>geoipLookup.getLocation(clientip)</pre>
          <p>This code will return a map containing the countryCode,city and longitude and latitude coordinates. </p>
          <pre>	countryCode:"CN",
	city:"Beijing"
	lat:39.928894
	long;116.3883</pre>
          <p>To pull out your countryCode, your synth will look something like this:</p>
          <pre>groovy-script:
def loc = geoipLookup.getLocation(clientIp)
return loc.countryCode</pre>
          <p> This can be reduced to just one line:</p>
          <pre>groovy-script: geoipLookup.getLocation(clientIp).countryCode</pre>
          <p>The City Synth  Field uses the following groovy script code</p>
          <pre>groovy-script: 
def loc = geoipLookup.getLocation(IpAddress)
if (loc.city != null) {
	String result = "'city':'" + loc.city + "',"
	result += "'lat':'" + loc.latitude + "',"
	result += "'lat':'" + loc.longitude + "'"
	return result;
}	</pre>
          <p>Save the type when you are done</p>
          <h3>Visualisation</h3>
          <p>The visualization is the easy part. Here is an example search</p>
          <pre> 
 _tag.equals(www) country.count() chart(map)</pre>
          <p>To include city level bubbles you would use the following search</p>
          <pre>_tag.equals(www) country.count() city.count() chart(map)</pre>
          <p>If you data type fields are not labelled country and city respectively you can alias them at search time. If my country data was stored in the field nation my search would look like this</p>
          <pre>_tag.equals(www) nation.count(,country) chart(map)</pre>
          <p>The second parameter <em>country</em> to the count analytic is an alias for the field nation. </p><br/><br/><br/>
          <div id="disqus_thread">
            <script>
              /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
              var disqus_shortname = 'logscape'; // required: replace example with your forum shortname
              /* * * DON'T EDIT BELOW THIS LINE * * */
              (function() {
              	var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
              	dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
              	(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
              })();
            </script>
          </div>
        </div>
      </div>
      <!--
      hr.dark 
      .col-md-3
      Logscape Copyright 2014(c) Registered Trademark 
      
      -->
    </div>
    <script>
      $( document ).ready(function() {
      
      	$("#cseSubmit").on("click",function(e){
      		e.preventDefault();
      		submit_form(); 
      	});
      	$("#searchBox").on("keypress",function(e){ 
      		if (e.keyCode == 13) { 
      			e.preventDefault();
      			submit_form() 
      		}
      	}); 
      });
      
    </script>
    <script>
      (function(g,i,a,n,t,s){g['SeeYourVisitors']=n;g[n]=g[n]||function(){
      (g[n].q=g[n].q||[]).push(arguments)},g[n].l=1*new Date();t=i.createElement(a),
      s=i.getElementsByTagName(a)[0];t.async=1;t.src='//seeyourvisitors2.appspot.com/gg.js';
      s.parentNode.insertBefore(t,s)})(window,document,'script','gg');
      gg('create', 'd1a8b082-8806-4793-936f-35f5e41b3592');
      gg('track');
    </script>
    <script src="js/ga.js"> </script>
  </body>
</html>