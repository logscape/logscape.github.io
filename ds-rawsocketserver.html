<!DOCTYPE html >
<html lang="en">
  <head>
    <title>	Logscape Documentation </title>
    <script src="js/kiss.js"> </script>
    <link href="css/bootstrap.min.css" rel="stylesheet"/>
    <link href="css/style.css" rel="stylesheet"/>
    <link href="css/font-awesome-4.0.3/css/font-awesome.min.css" rel="stylesheet"/>
    <link href="css/style-app.css" rel="stylesheet"/>
    <link href="css/app.css" rel="stylesheet"/>
    <link href="//vjs.zencdn.net/4.9/video-js.css" rel="stylesheet"/>
    <script src="//vjs.zencdn.net/4.9/video.js"></script>
    <script src="js/jquery-1.11.0.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script>
      var breadcrumbs={
      	"gettingstarted":"Getting Started" 
      	,"searching":"Search"
      		,"kv":"Data Discovery"
      		,"offsets":"Using Offsets"
      		,"geoip":"Geo IP"
      		,"pattern":"Using Search Patterns"
      		,"video":"tutorials"
      		,"overlays":"Overlaying Searches" 
      	,"starthere":""
      
      	,"ds":"Data Sources"
      		,"add":" Add a New Data Source" 
      		,"multitags":" Using Multi-Tags"
      		,"syslog":" Connect Syslog Clients" 
      		,"tags": " Sources and Tags" 
      		,"intelligent_field_discovery":" Intelligent Field Discovery" 
      	,"types":"Data Types"
      		,"system_fields":"System Fields" 
      	,"deploy":"Deployment" 
      		,"app":" Logscape Apps"
      		,"agents": "Agents "
      		,"architectures_default": " Default Deployment"
      		,"architectures_failover": "Failover" 
      		,"architectures_indexstores": " Index Stores" 
      		,"architectures_tenured":"Tenured Data"
      		,"architectures_zones":" Zones" 
      		,"Backup": "Backup" 
      			,"home":" The Home Workspace"
      			,"import":" Restoring from Backup"
      			,"partial": " Selective Import"
      
      		,"arch_zoning":"Distributed Topology" 
      		,"arch_clm":"Centralized Monitoring Topology" 
      		,"arch_indexstores":"Multiple Index Store Topology" 
      
      		,"rawtcpserver": "Tcp Server"
      		,"syslogserer":"Syslog Server"
      		,"centralconfigs":"Centralized Configuration"
      		,"boot_properties":"Boot Properties"
      
      	,"users":"Users"
      		,"datagroups": "Data Groups"
      			,"nested": "Nested Groups"
      		,"faq":"Frequently Asked Questions" 
      	,"ldap":"Active Directory" 
      };
      $(window).load(function(){
      	function genLink(arr,idx){
      		if (idx<0) { return "/"; } 
      		var l="/"
      		for(i=0;i<=idx;i++){
      			l=l +  arr[i] + "-" ;
      		}
      		return l.substring(0,l.length-1) + ".html";
      	}
      
      	function renderCrumbs(page){
      		console.log("rendering breadcrumbs for page:" + page)
      		if (page.indexOf("-") < 0){
      			return ""
      		}
      		var parts=page.split("-");
      		var idx=0;
      		console.log("rendering  " + parts);
      		var html="<a href='"+genLink(parts,-1)+"'> / Home </a>";
      		for(idx=0;idx<parts.length;idx++){
      			k=parts[idx];
      		
      			html=html + "<a href="+ genLink(parts,idx) + ">";
      			if (breadcrumbs.hasOwnProperty(k)){
      				html=html + " / " + breadcrumbs[k];
      			}else{
      				
      				html=html + " / " + k[0].toUpperCase() + k.substring(1,k.length);
      			}
      			console.log(".");
      		}
      		console.log("this far!!!");
      		return html
      	}
      	
      	var elems=window.location.href.split('?')[0].split('/');
      	var currentPage=elems[elems.length-1].split('.')[0]
      	console.log("crumb>" + renderCrumbs(currentPage));	
      	$('#widget-bc').html(renderCrumbs(currentPage));
      });
      
      
    </script>
    <script>
      var blogFeed;
      function parseRSS(url, callback) {
      	$.ajax({
      		url: document.location.protocol + '//ajax.googleapis.com/ajax/services/feed/load?v=1.0&num=10&callback=?&q=' + encodeURIComponent(url),
      		dataType: 'json',
      		success: function(data) {
      			callback(data.responseData.feed);
      		}});
      }
      
      $(window).load(function() { 
      	parseRSS("http://blog.logscape.com/feed",function(feed){
      		var num = feed.entries.length;
      		for(i=0;i< num;i++){
      			var title=feed.entries[i].title;
      			//var link=feed.entries[i].
      			link=feed.entries[i].link;
      			$(".resource-list ul").append("<li><a href='"+link+"'>"+title+"</a> </li>")
      			blogFeed=feed;
      		}
      	});
      });
      
    </script>
    <script>
      $(window).bind("pageshow",function(){
      	var $form= $("form")[0];
      	$form.reset(); 
      });
      
    </script>
    <script>
      function submit_form(){
      	var q=$("#searchBox").val() 
      	q=encodeURIComponent(q)
      	var query="https://www.google.com/?gws_rd=cr&q=site:logscape.github.io+#q=site:logscape.github.io+"+q
      	var location = window.location.href;
      	console.log("back:" + location);
      	history.pushState({},"",location); 
      	window.location.replace(query);
      }
      
    </script>
  </head>
  <body>
    <div style="width:100%;height:85px;background-color:#333;">
      <!--div
      a(href="/") Documentation
      a(href="")  Forums 	| 
      a(href="") Getting Started	|
      a(href="") Logscape  	| 
      
      
      -->
      <div style="padding-left:100px;padding-top:25px"><img src="images/logscape-apps-logo.png" style="height:45px"/>
        <div style="float:right" class="col-md-3">
          <form id="cse-search-box" action="" style="position:right;padding-top:5px;padding-bottom:5px" onSubmit="submit_form()">
            <input type="hidden" name="cx" value="015161349156186070243:ktxh8djpql8"/>
            <input type="hidden" name="ie" value="UTF-8"/>
            <input id="searchBox" type="text" name="q" size="31" style="margin-left:15px"/>
            <input id="cseSubmit" type="submit" value=" " class="btn-search"/>
          </form>
        </div>
      </div>
    </div>
    <div style="width:100%;height:40px;background-color:#EEE;box-shadow: 0 0 2px #999;">
      <div style="padding-left:140px;padding-top:10px;font-size:14px"><a href="http://apps.logscape.com">Apps |  </a><a href="/cloud.html">Cloud |  </a>
        <!--a(href="http://support.liquidlabs.co.uk") Release 1.3 | --><a href="http://logscape.activeboard.com/">Forums  | </a><a href="gettingstarted.html">Getting Started </a><img style="height:0;width:0" src="http://logscape.com/images/track.png?version=support"/>
      </div>
    </div>
    <!--.container-fluid.navbar(style="min-height:30px;margin-bottom:5px;")
    .row(style="height:5px") 
    .row
    	.col-md-8
    	.col-md-1
    -->
    <div class="container-fluid">
      <!--.row
      .col-md-7
      	form#cse-search-box(action="",style="position:right;padding-top:5px;padding-bottom:5px",onSubmit="submit_form()")
      		a(href="/")
      			img(src="images/logo.png",style="padding-top:0px,padding-right:15px",width="150") 
      		input(type="hidden",name="cx",value="partner-pub-2789521296837340:9402765321")
      		input(type="hidden",name="ie",value="UTF-8")
      		input#searchBox(type="text",name="q",size="31",style="margin-left:15px")
      		input.btn-search#cseSubmit(type="submit",value=" ")
      		&nbsp;&nbsp;
      		a(href="http://apps.logscape.com") Apps |  
      		a(href="http://support.liquidlabs.co.uk") Release 1.3 | 
      		a(href="http://logscape.activeboard.com/") Forums  | 
      		a(href="gettingstarted.html") Getting Started 
      
      -->
      <div class="row">
        <div class="col-md-1"></div>
        <div class="col-md-2"></div>
        <div class="col-md-5">
          <div id="widget-bc" padding-left:150px="padding-left:150px" class="breadcrumbs style">&nbsp;</div>
        </div>
      </div>
      <div class="row">
        <div style="width:100px" class="col-md-1">
          <p></p>
        </div>
        <div class="col-md-2 nav-padding">
          <ul class="nav nav-tabs nav-stacked"> 
            <li><a href="searching.html">Search</a></li>
            <li> <a href="workspaces.html">WorkSpaces</a>
              <ul></ul>
            </li>
            <li> <a href="ds.html">Data Sources</a></li>
            <li> <a href="types.html">Data Types </a></li>
            <li><a href="deploy.html">Deployment</a></li>
            <li><a href="users.html">Users </a></li>
            <li> <a href="alerts.html">Alerts 	</a></li>
            <li><a href="technology.html">Technology</a></li>
            <li><a href="release-notes.html">Release Notes</a></li>
            <li><a href="https://twitter.com/logscape" data-show-count="false" data-size="large" class="twitter-follow-button">Follow @logscape</a>
              <script>=!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
            </li>
          </ul>
          <div style="padding-left:50px"> 
            <h4>Articles </h4>
          </div>
          <hr/>
          <div class="resource-list">
            <ul style="list-style:none;padding-left:10px;background-color:#FFFEE7"> </ul>
          </div>
        </div>
        <div class="col-md-9 content-area"> 
          <div class="container-fluid">
            <div class="row">
              <div class="col-md-11">
                <h3>TCP Raw Socker Server</h3>
                <p>Logscape runs a socket server and can receive log data from any network client that supports TCP.  The Socket Server can receive data from many different sources</p>
                <ul>
                  <li>Open Source Log shippers - Beaver, Logstash, Collectd graphite plugin,etc</li>
                  <li>Snare Agents - A windows event log forwarder that uses the syslog protocol</li>
                  <li>Splunk forwarders</li>
                  <li>netcat - Unix system commands that writes text to an ip address and port </li>
                </ul>
                <h4>Data Sources </h4>
                <p>The raw socket servers default data source is 
                  <blockquote>socket-server 	</blockquote>
                </p>
                <p>which points to the ./work/SyslogServer_SERVER_/  by default, which is where it will generate the data.</p>
                <p> </p><strong>Configure Logscape Socket Server </strong>
                <p>Logscape runs a TCP SocketServer by default on port 9991.  To change the default port update the sysprops section with the following system property in the boot.properties file
                  <blockquote>	-Dsocket.server.port=22222</blockquote>
                  <blockquote>	-Dsocket.server.mapping=mapping.csv</blockquote>and then bounce the system.
                </p>
                <p>The Socket Server logs to the file ./work/socketserver.log. To change the directory where the Socket Server stores files update this property. </p>
                <blockquote>	 -Dsocket.server.root=/data/SocketServer </blockquote>
                <p>By default the Socket Server will store the raw socket stream before demultiplexing in a raw file. This can be disabled by using the following system property</p>
                <blockquote> -Dsocket.server.dump.raw=false</blockquote>
                <h3>How the Log TCP  Streaming works </h3>
                <p>Logscape accepts the incoming stream of data and inspects the contents looking for text patterns defined in the mapping.csv file. When Logscape comes across a known text pattern that log snippet is streamed off to the appropriate file and a configured data type is assigned. If the snippet is unrecognized it will be appended to the UNKNOWN.log file. </p><strong> Mapping configuration file </strong>
                <p>The mappings file is a csv file that configures the mapping of the log streams to files and directories. The file should be in the following location</p>
                <blockquote>$LOGSCAPE_HOME/mappings.csv </blockquote>
                <p>A sample mappings.csv file can be found at: </p>
                <blockquote>$LOGSCAPE_HOME/system-bundles/vs-log-server-1.0/mapping.csv</blockquote>
                <p>The file has the following format.</p>
                <table class="table">				
                  <tr>
                    <td>#  </td>
                    <td>#type-key</td>
                    <td>#timestamp</td>
                    <td>#mline=t/f,</td>
                    <td>#appendNL=true/false</td>
                    <td>post process pattern (DEPRECATED) </td>
                    <td>stream regex pattern </td>
                  </tr>
                  <tr>     
                    <td>1. </td>
                    <td>ASA-bridge </td>
                    <td> timestamp=false</td>
                    <td>mline=false</td>
                    <td>appendNL=false,</td>
                    <td> </td>
                    <td>(\d+\.\d+\.\d+\.\d+) AND ASA-bridge</td>
                  </tr>
                  <tr>
                    <td>2 </td>
                    <td>ASA </td>
                    <td>timestamp=false</td>
                    <td>mline=false</td>
                    <td>appendNL=false</td>
                    <td> </td>
                    <td>(\d+\.\d+\.\d+\.\d+) AND ASA-\d+</td>
                  </tr>
                </table>
                <p>In this example cisco logs are identified using the stream regex pattern. The stream is written down to a file using the type-key field with the date appended to it.					
                  <blockquote>	ASA-bridge-$YYMMDD.log </blockquote>
                </p>
                <p> Notice that the stream regex pattern uses a regex group. The group extracted is used to create a sub directory. In this example the extracted group is the  IP address of the originating device. </p>
                <div class="image">
                  <table style="background-color:#CCC" class="table">
                    <tr>
                      <td colspan="2" style="background-color:#AAA">
                        <center><strong>Mapping Csv Header </strong></center>
                      </td>
                    </tr>
                    <tr>
                      <td> <strong>type </strong></td>
                      <td>This is the type of file collected by the SocketServer. This will become the name of the file. </td>
                    </tr>
                    <tr>
                      <td> <strong>timestamp=true|false</strong></td>
                      <td>true/false 
                        <p>When this is set to true, Logscape will use the timestamp if the event contains one. When this is false, the time of arrival of the log event is used. </p>
                      </td>
                    </tr>
                    <tr>
                      <td> <strong>mline=true|false</strong></td>
                      <td>If the log stream contains multi-line events like exceptions  then this field must be set to  true.</td>
                    </tr>
                    <tr>
                      <td> <strong>appendNL=false </strong></td>
                      <td>	Append a new line to each log stream event </td>
                    </tr>
                    <tr>
                      <td> <strong>Post Process Pattern</strong></td>
                      <td>This field is depracated and should be left blank.</td>
                    </tr>
                    <tr>	
                      <td> <strong>log pattern</strong></td>
                      <td>The pattern is a regular expression used to identify the log event. Groups are optional. When they are used, each group is used as a directory name. A typical use case is extracting hostnames or unique ids. Each group creates a nested folder. </td>
                    </tr>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!--
      hr.dark 
      .col-md-3
      Logscape Copyright 2014(c) Registered Trademark 
      
      -->
    </div>
    <script>
      $( document ).ready(function() {
      
      	$("#cseSubmit").on("click",function(e){
      		e.preventDefault();
      		submit_form(); 
      	});
      	$("#searchBox").on("keypress",function(e){ 
      		if (e.keyCode == 13) { 
      			e.preventDefault();
      			submit_form() 
      		}
      	}); 
      });
      
    </script>
    <script>
      (function(g,i,a,n,t,s){g['SeeYourVisitors']=n;g[n]=g[n]||function(){
      (g[n].q=g[n].q||[]).push(arguments)},g[n].l=1*new Date();t=i.createElement(a),
      s=i.getElementsByTagName(a)[0];t.async=1;t.src='//seeyourvisitors2.appspot.com/gg.js';
      s.parentNode.insertBefore(t,s)})(window,document,'script','gg');
      gg('create', 'd1a8b082-8806-4793-936f-35f5e41b3592');
      gg('track');
    </script>
    <script src="js/ga.js"> </script>
  </body>
</html>